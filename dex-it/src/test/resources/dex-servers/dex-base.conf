# Common part of dex-1 and dex-2 configurations for integration-tests. This file contains all settings
# that override default ones defined in dex/src/main/resources/application.conf
waves.dex {

  root-directory = "/opt/waves-dex"

  address-scheme-character = "Y"

  account-storage {
    type = "in-mem"
    in-mem.seed-in-base64 = "jVXOEAR7WwbmTs4EMmp7jFBgkfiJv+HnzURKLMZiWqk="
  }

  ntp-server = "0.ru.pool.ntp.org"

  rest-api {
    address = "0.0.0.0"
    api-key-hash = "7L6GpLHhA5KyJTAVc8WFHwEcyTY8fC8rRbyMCiFnM4i"
  }

  grpc.integration {
    waves-node-grpc {
      # All Waves containers in integration tests are created with net alias = waves.nodes
      host = "waves.nodes"
      port = 6887
    }
  }

  rest-order-limit = 20

  events-queue {

    local.polling-interval = 100ms

    kafka {
      consumer {

        fetch-max-duration = 100ms
        max-buffer-size = 200

        client {
          heartbeat.interval.ms = 5000
          default.api.timeout.ms = 10000
          request.timeout.ms = 5000
          fetch.max.bytes = 30000
          fetch.max.duration.ms = 100
        }
      }

      producer.client {
        delivery.timeout.ms = 6000 # > request.timeout.ms + linger.ms
        max.request.size = 30000
      }
    }
  }
}

akka {
  actor {
    debug {
      lifecycle = on
      unhandled = on
    }

    loglevel = "INFO"
    loggers = ["akka.event.slf4j.Slf4jLogger"]

    logging-filter = "akka.event.slf4j.Slf4jLoggingFilter"
    log-dead-letters-during-shutdown = false
  }

  persistence {
    journal {
      plugin = akka.persistence.journal.leveldb
      leveldb {
        dir = "/opt/waves-dex/journal"
        native = on
      }
    }
    snapshot-store.plugin = waves.dex.snapshot-store
  }

  http.server {

    max-connections = 128
    request-timeout = 20s

    parsing {
      max-method-length = 64
      max-content-length = 1m
    }
  }
}